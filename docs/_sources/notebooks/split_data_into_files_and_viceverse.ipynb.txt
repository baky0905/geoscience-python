{
 "cells": [
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Split dataframe into multiple csv's and load multiple csv's into a single dataframe"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "## 1) Split dataframe into multiple csv's "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import glob\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>wlbWellboreName</th>\n      <th>wlbWell</th>\n      <th>wlbDrillingOperator</th>\n      <th>wlbProductionLicence</th>\n      <th>wlbPurpose</th>\n      <th>wlbStatus</th>\n      <th>wlbContent</th>\n      <th>wlbWellType</th>\n      <th>wlbSubSea</th>\n      <th>wlbEntryDate</th>\n      <th>...</th>\n      <th>wlbNpdidWellbore</th>\n      <th>dscNpdidDiscovery</th>\n      <th>fldNpdidField</th>\n      <th>fclNpdidFacilityDrilling</th>\n      <th>wlbNpdidWellboreReclass</th>\n      <th>prlNpdidProductionLicence</th>\n      <th>wlbNpdidSiteSurvey</th>\n      <th>wlbDateUpdated</th>\n      <th>wlbDateUpdatedMax</th>\n      <th>datesyncNPD</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>0</td>\n      <td>1/2-1</td>\n      <td>1/2-1</td>\n      <td>Phillips Petroleum Norsk AS</td>\n      <td>143</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>OIL</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>20.03.1989</td>\n      <td>...</td>\n      <td>1382</td>\n      <td>43814.0</td>\n      <td>3437650.0</td>\n      <td>296245.0</td>\n      <td>0</td>\n      <td>21956.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1</td>\n      <td>1/2-2</td>\n      <td>1/2-2</td>\n      <td>Paladin Resources Norge AS</td>\n      <td>143 CS</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>OIL SHOWS</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>14.12.2005</td>\n      <td>...</td>\n      <td>5192</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>278245.0</td>\n      <td>0</td>\n      <td>2424919.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>2</td>\n      <td>1/3-1</td>\n      <td>1/3-1</td>\n      <td>A/S Norske Shell</td>\n      <td>011</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>GAS</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>06.07.1968</td>\n      <td>...</td>\n      <td>154</td>\n      <td>43820.0</td>\n      <td>NaN</td>\n      <td>288604.0</td>\n      <td>0</td>\n      <td>20844.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>3</td>\n      <td>1/3-2</td>\n      <td>1/3-2</td>\n      <td>A/S Norske Shell</td>\n      <td>011</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>DRY</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>14.05.1969</td>\n      <td>...</td>\n      <td>165</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>288847.0</td>\n      <td>0</td>\n      <td>20844.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>4</td>\n      <td>1/3-3</td>\n      <td>1/3-3</td>\n      <td>Elf Petroleum Norge AS</td>\n      <td>065</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>OIL</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>22.08.1982</td>\n      <td>...</td>\n      <td>87</td>\n      <td>43826.0</td>\n      <td>1028599.0</td>\n      <td>288334.0</td>\n      <td>0</td>\n      <td>21316.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 87 columns</p>\n</div>",
      "text/plain": "  wlbWellboreName wlbWell          wlbDrillingOperator wlbProductionLicence  \\\n0           1/2-1   1/2-1  Phillips Petroleum Norsk AS                 143    \n1           1/2-2   1/2-2   Paladin Resources Norge AS               143 CS   \n2           1/3-1   1/3-1             A/S Norske Shell                 011    \n3           1/3-2   1/3-2             A/S Norske Shell                 011    \n4           1/3-3   1/3-3       Elf Petroleum Norge AS                 065    \n\n  wlbPurpose wlbStatus wlbContent  wlbWellType wlbSubSea wlbEntryDate  ...  \\\n0    WILDCAT       P&A        OIL  EXPLORATION        NO   20.03.1989  ...   \n1    WILDCAT       P&A  OIL SHOWS  EXPLORATION        NO   14.12.2005  ...   \n2    WILDCAT       P&A        GAS  EXPLORATION        NO   06.07.1968  ...   \n3    WILDCAT       P&A        DRY  EXPLORATION        NO   14.05.1969  ...   \n4    WILDCAT       P&A        OIL  EXPLORATION        NO   22.08.1982  ...   \n\n  wlbNpdidWellbore dscNpdidDiscovery fldNpdidField fclNpdidFacilityDrilling  \\\n0             1382           43814.0     3437650.0                 296245.0   \n1             5192               NaN           NaN                 278245.0   \n2              154           43820.0           NaN                 288604.0   \n3              165               NaN           NaN                 288847.0   \n4               87           43826.0     1028599.0                 288334.0   \n\n  wlbNpdidWellboreReclass  prlNpdidProductionLicence wlbNpdidSiteSurvey  \\\n0                       0                    21956.0                NaN   \n1                       0                  2424919.0                NaN   \n2                       0                    20844.0                NaN   \n3                       0                    20844.0                NaN   \n4                       0                    21316.0                NaN   \n\n  wlbDateUpdated  wlbDateUpdatedMax  datesyncNPD  \n0     03.10.2019         03.10.2019   08.12.2019  \n1     03.10.2019         03.10.2019   08.12.2019  \n2     03.10.2019         03.10.2019   08.12.2019  \n3     03.10.2019         03.10.2019   08.12.2019  \n4     03.10.2019         03.10.2019   08.12.2019  \n\n[5 rows x 87 columns]"
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "url = \"https://factpages.npd.no/ReportServer_npdpublic?/FactPages/TableView/wellbore_exploration_all&rs:Command=Render&rc:Toolbar=false&rc:Parameters=f&rs:Format=CSV&Top100=false&IpAddress=82.102.27.246&CultureCode=en\"\n",
    "\n",
    "wellbore_exploration_all = pd.read_csv(url)\n",
    "wellbore_exploration_all.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "In this excercise I would like to split the dataframe into groups from the column `wlbStatus`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": "P&A                      1652\nSUSPENDED                 123\nRE-CLASS TO DEV            51\nJUNKED                     48\nWILL NEVER BE DRILLED      25\nPLUGGED                     9\nDRILLING                    6\nRE-CLASS TO TEST            6\nBLOWOUT                     1\nName: wlbStatus, dtype: int64"
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wellbore_exploration_all[\"wlbStatus\"].value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (<ipython-input-25-596259b7a51a>, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  File \u001b[1;32m\"<ipython-input-25-596259b7a51a>\"\u001b[1;36m, line \u001b[1;32m1\u001b[0m\n\u001b[1;33m    Dataframe initialy has 1925 rows and 87 columns\u001b[0m\n\u001b[1;37m                     ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "Dataframe initialy has 1925 rows and 87 columns."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": "(1925, 87)"
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wellbore_exploration_all.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Before I group it I would like to get rid of the rows where the column is na."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>wlbWellboreName</th>\n      <th>wlbWell</th>\n      <th>wlbDrillingOperator</th>\n      <th>wlbProductionLicence</th>\n      <th>wlbPurpose</th>\n      <th>wlbStatus</th>\n      <th>wlbContent</th>\n      <th>wlbWellType</th>\n      <th>wlbSubSea</th>\n      <th>wlbEntryDate</th>\n      <th>...</th>\n      <th>wlbNpdidWellbore</th>\n      <th>dscNpdidDiscovery</th>\n      <th>fldNpdidField</th>\n      <th>fclNpdidFacilityDrilling</th>\n      <th>wlbNpdidWellboreReclass</th>\n      <th>prlNpdidProductionLicence</th>\n      <th>wlbNpdidSiteSurvey</th>\n      <th>wlbDateUpdated</th>\n      <th>wlbDateUpdatedMax</th>\n      <th>datesyncNPD</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>329</td>\n      <td>15/3-12 A</td>\n      <td>15/3-12</td>\n      <td>Equinor Energy AS</td>\n      <td>025</td>\n      <td>WILDCAT</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>8948</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>390874.0</td>\n      <td>0</td>\n      <td>34512.0</td>\n      <td>8190.0</td>\n      <td>13.11.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>703</td>\n      <td>25/7-9 S</td>\n      <td>25/7-9</td>\n      <td>ConocoPhillips Skandinavia AS</td>\n      <td>917</td>\n      <td>WILDCAT</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>8957</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>297865.0</td>\n      <td>0</td>\n      <td>30674650.0</td>\n      <td>8967.0</td>\n      <td>30.11.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1554</td>\n      <td>6506/5-1 S</td>\n      <td>6506/5-1</td>\n      <td>Aker BP ASA</td>\n      <td>100</td>\n      <td>WILDCAT</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>8961</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>507128.0</td>\n      <td>0</td>\n      <td>34040269.0</td>\n      <td>8939.0</td>\n      <td>06.12.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1847</td>\n      <td>7219/9-3</td>\n      <td>7219/9-3</td>\n      <td>Equinor Energy AS</td>\n      <td>532</td>\n      <td>WILDCAT</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>8960</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>439972.0</td>\n      <td>0</td>\n      <td>5463659.0</td>\n      <td>8794.0</td>\n      <td>06.12.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n  </tbody>\n</table>\n<p>4 rows × 87 columns</p>\n</div>",
      "text/plain": "     wlbWellboreName   wlbWell            wlbDrillingOperator  \\\n329        15/3-12 A   15/3-12              Equinor Energy AS   \n703         25/7-9 S    25/7-9  ConocoPhillips Skandinavia AS   \n1554      6506/5-1 S  6506/5-1                    Aker BP ASA   \n1847        7219/9-3  7219/9-3              Equinor Energy AS   \n\n     wlbProductionLicence wlbPurpose wlbStatus wlbContent  wlbWellType  \\\n329                  025     WILDCAT       NaN        NaN  EXPLORATION   \n703                  917     WILDCAT       NaN        NaN  EXPLORATION   \n1554                 100     WILDCAT       NaN        NaN  EXPLORATION   \n1847                 532     WILDCAT       NaN        NaN  EXPLORATION   \n\n     wlbSubSea wlbEntryDate  ... wlbNpdidWellbore dscNpdidDiscovery  \\\n329         NO          NaN  ...             8948               NaN   \n703         NO          NaN  ...             8957               NaN   \n1554        NO          NaN  ...             8961               NaN   \n1847        NO          NaN  ...             8960               NaN   \n\n     fldNpdidField fclNpdidFacilityDrilling wlbNpdidWellboreReclass  \\\n329            NaN                 390874.0                       0   \n703            NaN                 297865.0                       0   \n1554           NaN                 507128.0                       0   \n1847           NaN                 439972.0                       0   \n\n      prlNpdidProductionLicence wlbNpdidSiteSurvey wlbDateUpdated  \\\n329                     34512.0             8190.0     13.11.2019   \n703                  30674650.0             8967.0     30.11.2019   \n1554                 34040269.0             8939.0     06.12.2019   \n1847                  5463659.0             8794.0     06.12.2019   \n\n      wlbDateUpdatedMax  datesyncNPD  \n329                 NaN   08.12.2019  \n703                 NaN   08.12.2019  \n1554                NaN   08.12.2019  \n1847                NaN   08.12.2019  \n\n[4 rows x 87 columns]"
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wellbore_exploration_all[wellbore_exploration_all[\"wlbStatus\"].isna()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>wlbWellboreName</th>\n      <th>wlbWell</th>\n      <th>wlbDrillingOperator</th>\n      <th>wlbProductionLicence</th>\n      <th>wlbPurpose</th>\n      <th>wlbStatus</th>\n      <th>wlbContent</th>\n      <th>wlbWellType</th>\n      <th>wlbSubSea</th>\n      <th>wlbEntryDate</th>\n      <th>...</th>\n      <th>wlbNpdidWellbore</th>\n      <th>dscNpdidDiscovery</th>\n      <th>fldNpdidField</th>\n      <th>fclNpdidFacilityDrilling</th>\n      <th>wlbNpdidWellboreReclass</th>\n      <th>prlNpdidProductionLicence</th>\n      <th>wlbNpdidSiteSurvey</th>\n      <th>wlbDateUpdated</th>\n      <th>wlbDateUpdatedMax</th>\n      <th>datesyncNPD</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>0</td>\n      <td>1/2-1</td>\n      <td>1/2-1</td>\n      <td>Phillips Petroleum Norsk AS</td>\n      <td>143</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>OIL</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>20.03.1989</td>\n      <td>...</td>\n      <td>1382</td>\n      <td>43814.0</td>\n      <td>3437650.0</td>\n      <td>296245.0</td>\n      <td>0</td>\n      <td>21956.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1</td>\n      <td>1/2-2</td>\n      <td>1/2-2</td>\n      <td>Paladin Resources Norge AS</td>\n      <td>143 CS</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>OIL SHOWS</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>14.12.2005</td>\n      <td>...</td>\n      <td>5192</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>278245.0</td>\n      <td>0</td>\n      <td>2424919.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>2</td>\n      <td>1/3-1</td>\n      <td>1/3-1</td>\n      <td>A/S Norske Shell</td>\n      <td>011</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>GAS</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>06.07.1968</td>\n      <td>...</td>\n      <td>154</td>\n      <td>43820.0</td>\n      <td>NaN</td>\n      <td>288604.0</td>\n      <td>0</td>\n      <td>20844.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>3</td>\n      <td>1/3-2</td>\n      <td>1/3-2</td>\n      <td>A/S Norske Shell</td>\n      <td>011</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>DRY</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>14.05.1969</td>\n      <td>...</td>\n      <td>165</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>288847.0</td>\n      <td>0</td>\n      <td>20844.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>4</td>\n      <td>1/3-3</td>\n      <td>1/3-3</td>\n      <td>Elf Petroleum Norge AS</td>\n      <td>065</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>OIL</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>22.08.1982</td>\n      <td>...</td>\n      <td>87</td>\n      <td>43826.0</td>\n      <td>1028599.0</td>\n      <td>288334.0</td>\n      <td>0</td>\n      <td>21316.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <td>1920</td>\n      <td>7324/10-1</td>\n      <td>7324/10-1</td>\n      <td>Den norske stats oljeselskap a.s</td>\n      <td>162</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>SHOWS</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>03.06.1989</td>\n      <td>...</td>\n      <td>1411</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>294382.0</td>\n      <td>0</td>\n      <td>22108.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1921</td>\n      <td>7325/1-1</td>\n      <td>7325/1-1</td>\n      <td>Statoil Petroleum AS</td>\n      <td>615</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>GAS</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>23.06.2014</td>\n      <td>...</td>\n      <td>7501</td>\n      <td>24689817.0</td>\n      <td>NaN</td>\n      <td>404201.0</td>\n      <td>0</td>\n      <td>20429544.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>03.10.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1922</td>\n      <td>7325/4-1</td>\n      <td>7325/4-1</td>\n      <td>Statoil Petroleum AS</td>\n      <td>855</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>OIL/GAS</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>19.07.2017</td>\n      <td>...</td>\n      <td>8211</td>\n      <td>29469097.0</td>\n      <td>NaN</td>\n      <td>439972.0</td>\n      <td>0</td>\n      <td>28168828.0</td>\n      <td>NaN</td>\n      <td>13.11.2019</td>\n      <td>13.11.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1923</td>\n      <td>7335/3-1</td>\n      <td>7335/3-1</td>\n      <td>Equinor Energy AS</td>\n      <td>859</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>DRY</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>13.05.2019</td>\n      <td>...</td>\n      <td>8735</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>415836.0</td>\n      <td>0</td>\n      <td>28169055.0</td>\n      <td>NaN</td>\n      <td>17.10.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1924</td>\n      <td>7435/12-1</td>\n      <td>7435/12-1</td>\n      <td>Statoil Petroleum AS</td>\n      <td>859</td>\n      <td>WILDCAT</td>\n      <td>P&amp;A</td>\n      <td>GAS</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>09.08.2017</td>\n      <td>...</td>\n      <td>8228</td>\n      <td>29491696.0</td>\n      <td>NaN</td>\n      <td>439972.0</td>\n      <td>0</td>\n      <td>28169055.0</td>\n      <td>NaN</td>\n      <td>07.12.2019</td>\n      <td>07.12.2019</td>\n      <td>08.12.2019</td>\n    </tr>\n  </tbody>\n</table>\n<p>1921 rows × 87 columns</p>\n</div>",
      "text/plain": "     wlbWellboreName    wlbWell               wlbDrillingOperator  \\\n0              1/2-1      1/2-1       Phillips Petroleum Norsk AS   \n1              1/2-2      1/2-2        Paladin Resources Norge AS   \n2              1/3-1      1/3-1                  A/S Norske Shell   \n3              1/3-2      1/3-2                  A/S Norske Shell   \n4              1/3-3      1/3-3            Elf Petroleum Norge AS   \n...              ...        ...                               ...   \n1920       7324/10-1  7324/10-1  Den norske stats oljeselskap a.s   \n1921        7325/1-1   7325/1-1              Statoil Petroleum AS   \n1922        7325/4-1   7325/4-1              Statoil Petroleum AS   \n1923        7335/3-1   7335/3-1                 Equinor Energy AS   \n1924       7435/12-1  7435/12-1              Statoil Petroleum AS   \n\n     wlbProductionLicence wlbPurpose wlbStatus wlbContent  wlbWellType  \\\n0                    143     WILDCAT       P&A        OIL  EXPLORATION   \n1                  143 CS    WILDCAT       P&A  OIL SHOWS  EXPLORATION   \n2                    011     WILDCAT       P&A        GAS  EXPLORATION   \n3                    011     WILDCAT       P&A        DRY  EXPLORATION   \n4                    065     WILDCAT       P&A        OIL  EXPLORATION   \n...                   ...        ...       ...        ...          ...   \n1920                 162     WILDCAT       P&A      SHOWS  EXPLORATION   \n1921                 615     WILDCAT       P&A        GAS  EXPLORATION   \n1922                 855     WILDCAT       P&A    OIL/GAS  EXPLORATION   \n1923                 859     WILDCAT       P&A        DRY  EXPLORATION   \n1924                 859     WILDCAT       P&A        GAS  EXPLORATION   \n\n     wlbSubSea wlbEntryDate  ... wlbNpdidWellbore dscNpdidDiscovery  \\\n0           NO   20.03.1989  ...             1382           43814.0   \n1           NO   14.12.2005  ...             5192               NaN   \n2           NO   06.07.1968  ...              154           43820.0   \n3           NO   14.05.1969  ...              165               NaN   \n4           NO   22.08.1982  ...               87           43826.0   \n...        ...          ...  ...              ...               ...   \n1920        NO   03.06.1989  ...             1411               NaN   \n1921        NO   23.06.2014  ...             7501        24689817.0   \n1922        NO   19.07.2017  ...             8211        29469097.0   \n1923        NO   13.05.2019  ...             8735               NaN   \n1924        NO   09.08.2017  ...             8228        29491696.0   \n\n     fldNpdidField fclNpdidFacilityDrilling wlbNpdidWellboreReclass  \\\n0        3437650.0                 296245.0                       0   \n1              NaN                 278245.0                       0   \n2              NaN                 288604.0                       0   \n3              NaN                 288847.0                       0   \n4        1028599.0                 288334.0                       0   \n...            ...                      ...                     ...   \n1920           NaN                 294382.0                       0   \n1921           NaN                 404201.0                       0   \n1922           NaN                 439972.0                       0   \n1923           NaN                 415836.0                       0   \n1924           NaN                 439972.0                       0   \n\n      prlNpdidProductionLicence wlbNpdidSiteSurvey wlbDateUpdated  \\\n0                       21956.0                NaN     03.10.2019   \n1                     2424919.0                NaN     03.10.2019   \n2                       20844.0                NaN     03.10.2019   \n3                       20844.0                NaN     03.10.2019   \n4                       21316.0                NaN     03.10.2019   \n...                         ...                ...            ...   \n1920                    22108.0                NaN     03.10.2019   \n1921                 20429544.0                NaN     03.10.2019   \n1922                 28168828.0                NaN     13.11.2019   \n1923                 28169055.0                NaN     17.10.2019   \n1924                 28169055.0                NaN     07.12.2019   \n\n      wlbDateUpdatedMax  datesyncNPD  \n0            03.10.2019   08.12.2019  \n1            03.10.2019   08.12.2019  \n2            03.10.2019   08.12.2019  \n3            03.10.2019   08.12.2019  \n4            03.10.2019   08.12.2019  \n...                 ...          ...  \n1920         03.10.2019   08.12.2019  \n1921         03.10.2019   08.12.2019  \n1922         13.11.2019   08.12.2019  \n1923                NaN   08.12.2019  \n1924         07.12.2019   08.12.2019  \n\n[1921 rows x 87 columns]"
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wellbore_exploration_all = wellbore_exploration_all.dropna(subset=[\"wlbStatus\"])\n",
    "wellbore_exploration_all"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Now we have 4 rows less :)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": "(1921, 87)"
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wellbore_exploration_all.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Here goes the groupby column's cathegories."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "wellbore_exploration_all = wellbore_exploration_all.groupby(\"wlbStatus\")"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "The object is `DataFrameGroupBy`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": "<pandas.core.groupby.generic.DataFrameGroupBy object at 0x00000246801FD588>"
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wellbore_exploration_all"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "End goal of the first part is to write a separate csv file for each of the groups in the \"wlbStatus\" columns.\n",
    "\n",
    "Let's disect:\n",
    "\n",
    "* apply\n",
    "* lambda\n",
    "* f string\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n</div>",
      "text/plain": "Empty DataFrame\nColumns: []\nIndex: []"
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(wellbore_exploration_all\n",
    "    .apply(\n",
    "        lambda x: x.to_csv(\n",
    "            f'./source/data/multiple_files/{x.name}.csv', \n",
    "            index=False\n",
    "            )\n",
    "        )\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (<ipython-input-16-48b7494f4909>, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  File \u001b[1;32m\"<ipython-input-16-48b7494f4909>\"\u001b[1;36m, line \u001b[1;32m1\u001b[0m\n\u001b[1;33m    Voila - here are the csv files, for each of the group there is one csv.\u001b[0m\n\u001b[1;37m                   ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "Voila - here are the csv files, for each of the group there is one csv."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": "['./source/data/multiple_files\\\\BLOWOUT.csv',\n './source/data/multiple_files\\\\DRILLING.csv',\n './source/data/multiple_files\\\\JUNKED.csv',\n './source/data/multiple_files\\\\P&A.csv',\n './source/data/multiple_files\\\\PLUGGED.csv',\n './source/data/multiple_files\\\\RE-CLASS TO DEV.csv',\n './source/data/multiple_files\\\\RE-CLASS TO TEST.csv',\n './source/data/multiple_files\\\\SUSPENDED.csv',\n './source/data/multiple_files\\\\WILL NEVER BE DRILLED.csv']"
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "glob.glob(r\"./source/data/multiple_files/*.csv\")"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "## 2) load multiple csv's into a single dataframe"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Now that we have these multiple csv files we will reverse the process and concatenate them into a single pandas dataframe."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": "['./source/data/multiple_files\\\\BLOWOUT.csv',\n './source/data/multiple_files\\\\DRILLING.csv',\n './source/data/multiple_files\\\\JUNKED.csv',\n './source/data/multiple_files\\\\P&A.csv',\n './source/data/multiple_files\\\\PLUGGED.csv',\n './source/data/multiple_files\\\\RE-CLASS TO DEV.csv',\n './source/data/multiple_files\\\\RE-CLASS TO TEST.csv',\n './source/data/multiple_files\\\\SUSPENDED.csv',\n './source/data/multiple_files\\\\WILL NEVER BE DRILLED.csv']"
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list_of_filenames = glob.glob(r\"./source/data/multiple_files/*.csv\")\n",
    "list_of_filenames"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    " Method one is to just loop through each file in the list of relative filenames, load the dataframe and append it to a list_of_dfs."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": "0.09900069236755371\n"
    }
   ],
   "source": [
    "import time\n",
    "start = time.time()\n",
    "\n",
    "list_of_dfs = []\n",
    "for filename in list_of_filenames:\n",
    "    df = pd.read_csv(filename)\n",
    "    list_of_dfs.append(df)\n",
    "\n",
    "end = time.time()\n",
    "print(end - start)"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Similar process is demoed here but using list comprehensions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": "0.1060032844543457\n"
    }
   ],
   "source": [
    "import time\n",
    "start = time.time()\n",
    "\n",
    "list_of_dfs = [pd.read_csv(filename) for filename in list_of_filenames]\n",
    "\n",
    "end = time.time()\n",
    "print(end - start)"
   ]
  },
  {
   "cell_type": "markdown",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Last step is to concatenate all the dataframes from the list into a single dataframe an in the meanwhile to ignore the original indexes."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "wellbore_exploration_all_NEW = pd.concat(list_of_dfs, ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>wlbWellboreName</th>\n      <th>wlbWell</th>\n      <th>wlbDrillingOperator</th>\n      <th>wlbProductionLicence</th>\n      <th>wlbPurpose</th>\n      <th>wlbStatus</th>\n      <th>wlbContent</th>\n      <th>wlbWellType</th>\n      <th>wlbSubSea</th>\n      <th>wlbEntryDate</th>\n      <th>...</th>\n      <th>wlbNpdidWellbore</th>\n      <th>dscNpdidDiscovery</th>\n      <th>fldNpdidField</th>\n      <th>fclNpdidFacilityDrilling</th>\n      <th>wlbNpdidWellboreReclass</th>\n      <th>prlNpdidProductionLicence</th>\n      <th>wlbNpdidSiteSurvey</th>\n      <th>wlbDateUpdated</th>\n      <th>wlbDateUpdatedMax</th>\n      <th>datesyncNPD</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>1916</td>\n      <td>6407/7-3 R</td>\n      <td>6407/7-3</td>\n      <td>Norsk Hydro Produksjon AS</td>\n      <td>107</td>\n      <td>APPRAISAL</td>\n      <td>WILL NEVER BE DRILLED</td>\n      <td>NaN</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>4638</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0</td>\n      <td>21660.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1917</td>\n      <td>6407/7-4 R</td>\n      <td>6407/7-4</td>\n      <td>Norsk Hydro Produksjon AS</td>\n      <td>107</td>\n      <td>APPRAISAL</td>\n      <td>WILL NEVER BE DRILLED</td>\n      <td>NaN</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>4639</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0</td>\n      <td>21660.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1918</td>\n      <td>6608/10-7 A</td>\n      <td>6608/10-7</td>\n      <td>Den norske stats oljeselskap a.s</td>\n      <td>128</td>\n      <td>APPRAISAL</td>\n      <td>WILL NEVER BE DRILLED</td>\n      <td>NaN</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>4274</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0</td>\n      <td>21836.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1919</td>\n      <td>6710/6-1</td>\n      <td>6710/6-1</td>\n      <td>Norsk Hydro Produksjon AS</td>\n      <td>219</td>\n      <td>WILDCAT</td>\n      <td>WILL NEVER BE DRILLED</td>\n      <td>NaN</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>3307</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0</td>\n      <td>22564.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n    <tr>\n      <td>1920</td>\n      <td>7223/5-1 A</td>\n      <td>7223/5-1</td>\n      <td>StatoilHydro Petroleum AS</td>\n      <td>228</td>\n      <td>APPRAISAL</td>\n      <td>WILL NEVER BE DRILLED</td>\n      <td>NaN</td>\n      <td>EXPLORATION</td>\n      <td>NO</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>6011</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>289333.0</td>\n      <td>0</td>\n      <td>22636.0</td>\n      <td>NaN</td>\n      <td>03.10.2019</td>\n      <td>NaN</td>\n      <td>08.12.2019</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 87 columns</p>\n</div>",
      "text/plain": "     wlbWellboreName    wlbWell               wlbDrillingOperator  \\\n1916      6407/7-3 R   6407/7-3         Norsk Hydro Produksjon AS   \n1917      6407/7-4 R   6407/7-4         Norsk Hydro Produksjon AS   \n1918     6608/10-7 A  6608/10-7  Den norske stats oljeselskap a.s   \n1919        6710/6-1   6710/6-1         Norsk Hydro Produksjon AS   \n1920      7223/5-1 A   7223/5-1         StatoilHydro Petroleum AS   \n\n     wlbProductionLicence wlbPurpose              wlbStatus wlbContent  \\\n1916                 107   APPRAISAL  WILL NEVER BE DRILLED        NaN   \n1917                 107   APPRAISAL  WILL NEVER BE DRILLED        NaN   \n1918                 128   APPRAISAL  WILL NEVER BE DRILLED        NaN   \n1919                 219     WILDCAT  WILL NEVER BE DRILLED        NaN   \n1920                 228   APPRAISAL  WILL NEVER BE DRILLED        NaN   \n\n      wlbWellType wlbSubSea wlbEntryDate  ... wlbNpdidWellbore  \\\n1916  EXPLORATION        NO          NaN  ...             4638   \n1917  EXPLORATION        NO          NaN  ...             4639   \n1918  EXPLORATION        NO          NaN  ...             4274   \n1919  EXPLORATION        NO          NaN  ...             3307   \n1920  EXPLORATION        NO          NaN  ...             6011   \n\n     dscNpdidDiscovery fldNpdidField fclNpdidFacilityDrilling  \\\n1916               NaN           NaN                      NaN   \n1917               NaN           NaN                      NaN   \n1918               NaN           NaN                      NaN   \n1919               NaN           NaN                      NaN   \n1920               NaN           NaN                 289333.0   \n\n     wlbNpdidWellboreReclass  prlNpdidProductionLicence wlbNpdidSiteSurvey  \\\n1916                       0                    21660.0                NaN   \n1917                       0                    21660.0                NaN   \n1918                       0                    21836.0                NaN   \n1919                       0                    22564.0                NaN   \n1920                       0                    22636.0                NaN   \n\n     wlbDateUpdated  wlbDateUpdatedMax  datesyncNPD  \n1916     03.10.2019                NaN   08.12.2019  \n1917     03.10.2019                NaN   08.12.2019  \n1918     03.10.2019                NaN   08.12.2019  \n1919     03.10.2019                NaN   08.12.2019  \n1920     03.10.2019                NaN   08.12.2019  \n\n[5 rows x 87 columns]"
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wellbore_exploration_all_NEW.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": "(1921, 87)"
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wellbore_exploration_all_NEW.shape\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:minimal_ds]",
   "language": "python",
   "name": "conda-env-minimal_ds-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}