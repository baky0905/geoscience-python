<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>Select columns and filter rows</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <link rel="stylesheet" href="../_static/theme.css">
      <link rel="stylesheet" href="../_static/sphinx_press_theme.css">
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

      
      <script src="../_static/theme-vendors.js"></script>
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Group By, Summary Statistic and New Columns" href="group_by_aggregate_assign.html" />
  <link rel="prev" title="Load *.csv and clean column names" href="cleaning_columns_names.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">Geoscience with Python</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Introduction
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Data Sources
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Crash Course on Python Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Easy Plotting:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link  router-link-active">
         Pandas Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Exploratory Data Analysis (EDA) case studies - IN PROGRESS:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Well Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Seismic Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Spatial Data - IN PROGRESS
      </a>
    </div>
  



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Introduction
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Data Sources
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Crash Course on Python Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Easy Plotting:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link  router-link-active">
         Pandas Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Exploratory Data Analysis (EDA) case studies - IN PROGRESS:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Well Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Seismic Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Spatial Data - IN PROGRESS
      </a>
    </div>
  



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Introduction</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../additional/welcome.html" class="reference internal ">Welcome to Geoscience with Python!</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Data Sources</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../additional/data_sources.html" class="reference internal ">Data sources used</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Crash Course on Python Basics:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="crash.html" class="reference internal ">Crash Course on Python Basics</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Easy Plotting:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="plotly_express_intro.html" class="reference internal ">Intro to Interactive Plotting with plotly_express</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Pandas Basics:</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="cleaning_columns_names.html" class="reference internal ">Load *.csv and clean column names</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">Select columns and filter rows</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#Select-columns-with-.filter-method" class="reference internal">Select columns with .filter method</a></li>
                
                  <li class="toctree-l2"><a href="#Filter-Dataframe" class="reference internal">Filter Dataframe</a></li>
                
                  <li class="toctree-l2"><a href="#Sort-Dataframe" class="reference internal">Sort Dataframe</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="group_by_aggregate_assign.html" class="reference internal ">Group By, Summary Statistic and New Columns</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="melt_and_pivot_table.html" class="reference internal ">Reshape your dataframe to wide and long formats</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="method_chaining_pandas.html" class="reference internal ">How method chaining in pandas is and can be super effective</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="split_data_into_files_and_viceverse.html" class="reference internal ">Split dataframe into multiple csv’s and load multiple csv’s into a single dataframe</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Exploratory Data Analysis (EDA) case studies - IN PROGRESS:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="annual_hydrocarbon_production_NCS.html" class="reference internal ">Annual Hydrocarebon Production</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Well Data - IN PROGRESS</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Seismic Data - IN PROGRESS</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Spatial Data - IN PROGRESS</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li>Select columns and filter rows</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="cleaning_columns_names.html"
       title="previous chapter">← Load *.csv and clean column names</a>
  </li>
  <li class="next">
    <a href="group_by_aggregate_assign.html"
       title="next chapter">Group By, Summary Statistic and New Columns →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Select-columns-and-filter-rows">
<h1>Select columns and filter rows<a class="headerlink" href="#Select-columns-and-filter-rows" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Select-columns-with-.filter-method">
<h2>Select columns with <strong>.filter</strong> method<a class="headerlink" href="#Select-columns-with-.filter-method" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">local_relative_path</span> <span class="o">=</span> <span class="s2">&quot;./source/data_processed/wellbore_exploration_all_clean_names.csv&quot;</span>
<span class="n">wellbore_exploration_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">local_relative_path</span><span class="p">)</span>
<span class="n">wellbore_exploration_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>production_licence</th>
      <th>purpose</th>
      <th>status</th>
      <th>content</th>
      <th>well_type</th>
      <th>sub_sea</th>
      <th>entry_date</th>
      <th>...</th>
      <th>npdid_wellbore</th>
      <th>dsc_npdid_discovery</th>
      <th>npdid_field</th>
      <th>npdid_facility_drilling</th>
      <th>npdid_wellbore_reclass</th>
      <th>l_npdid_production_licence</th>
      <th>npdid_site_survey</th>
      <th>date_updated</th>
      <th>date_updated_max</th>
      <th>datesync_npd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>1/2-1</td>
      <td>Phillips Petroleum Norsk AS</td>
      <td>143</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>20.03.1989</td>
      <td>...</td>
      <td>1382</td>
      <td>43814.0</td>
      <td>3437650.0</td>
      <td>296245.0</td>
      <td>0</td>
      <td>21956.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1/2-2</td>
      <td>1/2-2</td>
      <td>Paladin Resources Norge AS</td>
      <td>143 CS</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL SHOWS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.12.2005</td>
      <td>...</td>
      <td>5192</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>278245.0</td>
      <td>0</td>
      <td>2424919.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1/3-1</td>
      <td>1/3-1</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>06.07.1968</td>
      <td>...</td>
      <td>154</td>
      <td>43820.0</td>
      <td>NaN</td>
      <td>288604.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1/3-2</td>
      <td>1/3-2</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>DRY</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.05.1969</td>
      <td>...</td>
      <td>165</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>288847.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1/3-3</td>
      <td>1/3-3</td>
      <td>Elf Petroleum Norge AS</td>
      <td>065</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>22.08.1982</td>
      <td>...</td>
      <td>87</td>
      <td>43826.0</td>
      <td>1028599.0</td>
      <td>288334.0</td>
      <td>0</td>
      <td>21316.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 87 columns</p>
</div></div>
</div>
<p>You select columns in a dataframe by using <code class="docutils literal notranslate"><span class="pre">.filter</span> <span class="pre">method*</span></code> which is a bit non-inuitive(in my head) since we use it to select columns by column name, and we “<strong>filter</strong>” the columns by a condition using <code class="docutils literal notranslate"><span class="pre">.query*</span></code> method. It is what it is :)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">wellbore_exploration_all</span>
  <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wellbore_name&quot;</span><span class="p">,</span> <span class="s2">&quot;well_type&quot;</span><span class="p">])</span>
<span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>EXPLORATION</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1/2-2</td>
      <td>EXPLORATION</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1/3-1</td>
      <td>EXPLORATION</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1/3-2</td>
      <td>EXPLORATION</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1/3-3</td>
      <td>EXPLORATION</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Filter-Dataframe">
<h2>Filter Dataframe<a class="headerlink" href="#Filter-Dataframe" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Filter-with-.query-method">
<h3>Filter with <strong>.query</strong> method<a class="headerlink" href="#Filter-with-.query-method" title="Permalink to this headline">¶</a></h3>
<p>Filter the dataframe by the elements from the list which is defined as a part of the query argument.</p>
<p><strong>REMEMBER SINGLE QUOTES WITHIN DOUBLE QUOTES.</strong></p>
<p><strong>NOTE: for columns with spaces in their name, you can use backtick quoting.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">wellbore_exploration_all</span>
  <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wellbore_name&quot;</span><span class="p">,</span> <span class="s2">&quot;well_type&quot;</span><span class="p">])</span>
  <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;wellbore_name in [&#39;1/2-1&#39;, &#39;7324/10-1&#39;]&quot;</span><span class="p">)</span>
<span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>EXPLORATION</td>
    </tr>
    <tr>
      <td>1917</td>
      <td>7324/10-1</td>
      <td>EXPLORATION</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Query-by-multiple-conditions">
<h3>Query by multiple conditions<a class="headerlink" href="#Query-by-multiple-conditions" title="Permalink to this headline">¶</a></h3>
<p>Here we just added three conditions to filter the dataframe. Note that I had to use <code class="docutils literal notranslate"><span class="pre">\</span></code> withing the .query’s expression just to make it a bit more readable, i.e. every condition needs to be in its own separate line.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">wellbore_exploration_all</span>
   <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;drilling_operator&quot;</span><span class="p">,</span> <span class="s2">&quot;purpose&quot;</span><span class="p">,</span> <span class="s2">&quot;total_depth&quot;</span><span class="p">])</span>
   <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;drilling_operator in [&quot;A/S Norske Shell&quot;, &quot;Statoil Petroleum AS&quot;] &amp; </span><span class="se">\</span>
<span class="s1">           purpose in &quot;WILDCAT&quot; &amp; </span><span class="se">\</span>
<span class="s1">           1000 &lt; total_depth &lt; 2000&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drilling_operator</th>
      <th>purpose</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>298</td>
      <td>A/S Norske Shell</td>
      <td>WILDCAT</td>
      <td>1971.0</td>
    </tr>
    <tr>
      <td>788</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1890.0</td>
    </tr>
    <tr>
      <td>1289</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1640.0</td>
    </tr>
    <tr>
      <td>1537</td>
      <td>A/S Norske Shell</td>
      <td>WILDCAT</td>
      <td>1920.0</td>
    </tr>
    <tr>
      <td>1831</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1033.0</td>
    </tr>
    <tr>
      <td>1850</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1594.0</td>
    </tr>
    <tr>
      <td>1853</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1780.0</td>
    </tr>
    <tr>
      <td>1860</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1855.0</td>
    </tr>
    <tr>
      <td>1898</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1500.0</td>
    </tr>
    <tr>
      <td>1901</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1540.0</td>
    </tr>
    <tr>
      <td>1907</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1090.0</td>
    </tr>
    <tr>
      <td>1916</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1100.0</td>
    </tr>
    <tr>
      <td>1919</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1210.0</td>
    </tr>
    <tr>
      <td>1921</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1540.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### Query by a predefined list</span>
</pre></div>
</div>
</div>
<p>Now we have a list of top 10 operator companies based on the amount wells drilled on the Norwegian Continental Shelf. Since the data contains historical records you will see some old names for the recent companies.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">operators_top_10</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Norsk Hydro Produksjon AS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Statoil Petroleum AS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Saga Petroleum ASA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lundin Norway AS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Esso Exploration and Production Norway A/S&#39;</span><span class="p">,</span>
 <span class="s1">&#39;A/S Norske Shell&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Elf Petroleum Norge AS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Phillips Petroleum Company Norway&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Statoil ASA (old)&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>We can refer to variables in the environment by prefixing them with an <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> character like for example <code class="docutils literal notranslate"><span class="pre">&#64;operators_top_10</span></code>, i.e.</p>
<p><code class="docutils literal notranslate"><span class="pre">.query(&quot;drilling_operator</span> <span class="pre">==</span> <span class="pre">**&#64;operators_top_10**&quot;)</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">wellbore_exploration_all</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;drilling_operator&#39;</span><span class="p">,</span> <span class="s2">&quot;drilling_days&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;drilling_operator == @operators_top_10&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drilling_operator</th>
      <th>drilling_days</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>A/S Norske Shell</td>
      <td>129</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A/S Norske Shell</td>
      <td>75</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Elf Petroleum Norge AS</td>
      <td>216</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Elf Petroleum Norge AS</td>
      <td>83</td>
    </tr>
    <tr>
      <td>6</td>
      <td>A/S Norske Shell</td>
      <td>134</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>1907</td>
      <td>Statoil Petroleum AS</td>
      <td>19</td>
    </tr>
    <tr>
      <td>1916</td>
      <td>Statoil Petroleum AS</td>
      <td>11</td>
    </tr>
    <tr>
      <td>1918</td>
      <td>Statoil Petroleum AS</td>
      <td>29</td>
    </tr>
    <tr>
      <td>1919</td>
      <td>Statoil Petroleum AS</td>
      <td>16</td>
    </tr>
    <tr>
      <td>1921</td>
      <td>Statoil Petroleum AS</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
<p>948 rows × 2 columns</p>
</div></div>
</div>
</div>
</div>
<div class="section" id="Sort-Dataframe">
<h2>Sort Dataframe<a class="headerlink" href="#Sort-Dataframe" title="Permalink to this headline">¶</a></h2>
<p>Sort based on values in a single column:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">wellbore_exploration_all</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;drilling_operator&#39;</span><span class="p">,</span> <span class="s2">&quot;drilling_days&quot;</span><span class="p">,</span> <span class="s2">&quot;total_depth&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;total_depth&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drilling_operator</th>
      <th>drilling_days</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1257</td>
      <td>Statoil ASA (old)</td>
      <td>49</td>
      <td>7928.0</td>
    </tr>
    <tr>
      <td>1276</td>
      <td>Statoil Petroleum AS</td>
      <td>32</td>
      <td>7811.0</td>
    </tr>
    <tr>
      <td>1260</td>
      <td>Statoil ASA (old)</td>
      <td>27</td>
      <td>7725.0</td>
    </tr>
    <tr>
      <td>1258</td>
      <td>Statoil ASA (old)</td>
      <td>67</td>
      <td>7594.0</td>
    </tr>
    <tr>
      <td>293</td>
      <td>Den norske stats oljeselskap a.s</td>
      <td>203</td>
      <td>7584.0</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>1332</td>
      <td>Equinor Energy AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>702</td>
      <td>ConocoPhillips Skandinavia AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>295</td>
      <td>Talisman Energy Norge AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>1757</td>
      <td>Norsk Hydro Produksjon AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>281</td>
      <td>Spirit Energy Norway AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1922 rows × 3 columns</p>
</div></div>
</div>
<p>Sort based on the values in multiple columns.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">wellbore_exploration_all</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;drilling_operator&#39;</span><span class="p">,</span> <span class="s2">&quot;drilling_days&quot;</span><span class="p">,</span> <span class="s2">&quot;total_depth&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;drilling_operator&quot;</span><span class="p">,</span> <span class="s2">&quot;drilling_days&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drilling_operator</th>
      <th>drilling_days</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1478</td>
      <td>Wintershall Norge ASA</td>
      <td>112</td>
      <td>4177.0</td>
    </tr>
    <tr>
      <td>1447</td>
      <td>Wintershall Norge ASA</td>
      <td>87</td>
      <td>4216.0</td>
    </tr>
    <tr>
      <td>1368</td>
      <td>Wintershall Norge ASA</td>
      <td>66</td>
      <td>3585.0</td>
    </tr>
    <tr>
      <td>1366</td>
      <td>Wintershall Norge ASA</td>
      <td>55</td>
      <td>2807.0</td>
    </tr>
    <tr>
      <td>1317</td>
      <td>Wintershall Norge ASA</td>
      <td>47</td>
      <td>3006.0</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>1538</td>
      <td>A/S Norske Shell</td>
      <td>13</td>
      <td>1800.0</td>
    </tr>
    <tr>
      <td>1534</td>
      <td>A/S Norske Shell</td>
      <td>12</td>
      <td>1804.0</td>
    </tr>
    <tr>
      <td>1546</td>
      <td>A/S Norske Shell</td>
      <td>10</td>
      <td>1805.0</td>
    </tr>
    <tr>
      <td>961</td>
      <td>A/S Norske Shell</td>
      <td>9</td>
      <td>5035.0</td>
    </tr>
    <tr>
      <td>1462</td>
      <td>A/S Norske Shell</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1922 rows × 3 columns</p>
</div></div>
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="cleaning_columns_names.html"
       title="previous chapter">← Load *.csv and clean column names</a>
  </li>
  <li class="next">
    <a href="group_by_aggregate_assign.html"
       title="next chapter">Group By, Summary Statistic and New Columns →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright Kristijan Bakaric.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>