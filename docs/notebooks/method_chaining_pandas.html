<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>How method chaining in pandas is and can be super effective</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <link rel="stylesheet" href="../_static/theme.css">
      <link rel="stylesheet" href="../_static/sphinx_press_theme.css">
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

      
      <script src="../_static/theme-vendors.js"></script>
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Split dataframe into multiple csv’s and load multiple csv’s into a single dataframe" href="split_data_into_files_and_viceverse.html" />
  <link rel="prev" title="Reshape your dataframe to wide and long formats" href="melt_and_pivot_table.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">Geoscience with Python</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Introduction
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Data Sources
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Crash Course on Python Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Easy Plotting:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link  router-link-active">
         Pandas Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Exploratory Data Analysis (EDA) case studies - IN PROGRESS:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Well Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Seismic Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Spatial Data - IN PROGRESS
      </a>
    </div>
  



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Introduction
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Data Sources
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Crash Course on Python Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Easy Plotting:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link  router-link-active">
         Pandas Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Exploratory Data Analysis (EDA) case studies - IN PROGRESS:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Well Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Seismic Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Spatial Data - IN PROGRESS
      </a>
    </div>
  



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Introduction</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../additional/welcome.html" class="reference internal ">Welcome to Geoscience with Python!</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Data Sources</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../additional/data_sources.html" class="reference internal ">Data sources used</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Crash Course on Python Basics:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="crash.html" class="reference internal ">Crash Course on Python Basics</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Easy Plotting:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="plotly_express_intro.html" class="reference internal ">Intro to Interactive Plotting with plotly_express</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Pandas Basics:</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="cleaning_columns_names.html" class="reference internal ">Load *.csv and clean column names</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="select_and_query.html" class="reference internal ">Select columns and filter rows</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="group_by_aggregate_assign.html" class="reference internal ">Group By, Summary Statistic and New Columns</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="melt_and_pivot_table.html" class="reference internal ">Reshape your dataframe to wide and long formats</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">How method chaining in pandas is and can be super effective</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#Readable-and-understandable-code---chaining" class="reference internal">Readable and understandable code - chaining</a></li>
                
                  <li class="toctree-l2"><a href="#pipe-seaborn’s-scatterplot-into-chain-of-methods" class="reference internal">pipe seaborn’s scatterplot into chain of methods</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="split_data_into_files_and_viceverse.html" class="reference internal ">Split dataframe into multiple csv’s and load multiple csv’s into a single dataframe</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Exploratory Data Analysis (EDA) case studies - IN PROGRESS:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="annual_hydrocarbon_production_NCS.html" class="reference internal ">Annual Hydrocarebon Production</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Well Data - IN PROGRESS</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Seismic Data - IN PROGRESS</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-geoscience-with-python-the-easy-way">Spatial Data - IN PROGRESS</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li>How method chaining in pandas is and can be super effective</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="melt_and_pivot_table.html"
       title="previous chapter">← Reshape your dataframe to wide and long formats</a>
  </li>
  <li class="next">
    <a href="split_data_into_files_and_viceverse.html"
       title="next chapter">Split dataframe into multiple csv’s and load multiple csv’s into a single dataframe →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="How-method-chaining-in-pandas-is-and-can-be-super-effective">
<h1>How method chaining in pandas is and can be super effective<a class="headerlink" href="#How-method-chaining-in-pandas-is-and-can-be-super-effective" title="Permalink to this headline">¶</a></h1>
<p>Method chaining is a programmatic style of invoking multiple method calls sequentially with each call performing an action on the same object and returning it.</p>
<p>It eliminates the cognitive burden of naming variables at each intermediate step.</p>
<p>Fluent Interface, a method of creating object-oriented API relies on method cascading (aka method chaining).</p>
<p>Method chaining substantially increases the readability of the code.</p>
<p>It is a top down approach.</p>
<div class="section" id="Readable-and-understandable-code---chaining">
<h2>Readable and understandable code - chaining<a class="headerlink" href="#Readable-and-understandable-code---chaining" title="Permalink to this headline">¶</a></h2>
<p>I will always try to avoid the following two ways of writing code:</p>
<p><strong>1) MUTLIPLE OBJECT OPTION</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eat</span><span class="p">(</span>

    <span class="nb">slice</span><span class="p">(</span>

        <span class="n">bake</span><span class="p">(</span>

            <span class="n">put</span><span class="p">(</span>
                <span class="n">pour</span><span class="p">(</span>

                    <span class="n">mix</span><span class="p">(</span><span class="n">ingredients</span><span class="p">),</span>

                    <span class="n">into</span><span class="o">=</span><span class="n">baking_form</span><span class="p">),</span>

                    <span class="n">into</span><span class="o">=</span><span class="n">oven</span><span class="p">),</span>

                <span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>

            <span class="n">pieces</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
        <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This first option is considered a “nested” option such that functions are nested within one another. Historically, this has been the traditional way of integrating code; however, it becomes extremely difficult to read what exactly the code is doing and it also becomes easier to make mistakes when making updates to your code. Although not in violation of the DRY principle1, it definitely violates the basic principle of readability and clarity, which makes communication of your analysis more
difficult. To make things more readable, people often move to the following approach…</p>
<p><strong>2) NESTED OPTION</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="o">=</span> <span class="n">mix</span><span class="p">(</span><span class="n">ingredients</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">pour</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">into</span><span class="o">=</span><span class="n">baking_form</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">put</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">into</span><span class="o">=</span><span class="n">oven</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">bake</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">pieces</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">eat</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This second option helps in making the data wrangling steps more explicit and obvious. By sequencing multiple functions in this way you are likely saving multiple outputs that are not very informative to you or others; rather, the only reason you save them is to insert them into the next function to eventually get the final output you desire. This inevitably creates unnecessary copies and wrecks havoc on properly managing your objects…basically it results in a global environment foxtrot charlie!</p>
<p>** CHAINING METHOD (if and when python and pandas allows you)**</p>
<p>To provide the same readability (or even better), we can use chaining of methods to string these arguments together without unnecessary object creation…</p>
<p>The point of the chain is to help you write code in a way that is easier to read and understand. It is powerful tool for clearly expressing a sequence of multiple operations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ingredients</span>

    <span class="o">.</span><span class="n">mix</span><span class="p">()</span>

    <span class="o">.</span><span class="n">pour</span><span class="p">(</span><span class="n">into</span><span class="o">=</span><span class="n">baking_form</span><span class="p">)</span>

    <span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">into</span><span class="o">=</span><span class="n">oven</span><span class="p">)</span>

    <span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

    <span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">pieces</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

    <span class="o">.</span><span class="n">ear</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">janitor</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">well_exploration_original</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://factpages.npd.no/ReportServer_npdpublic?/FactPages/TableView/wellbore_exploration_all&amp;rs:Command=Render&amp;rc:Toolbar=false&amp;rc:Parameters=f&amp;rs:Format=CSV&amp;Top100=false&amp;IpAddress=82.102.27.246&amp;CultureCode=en&quot;</span><span class="p">)</span>

<span class="n">well_exploration</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://factpages.npd.no/ReportServer_npdpublic?/FactPages/TableView/wellbore_exploration_all&amp;rs:Command=Render&amp;rc:Toolbar=false&amp;rc:Parameters=f&amp;rs:Format=CSV&amp;Top100=false&amp;IpAddress=82.102.27.246&amp;CultureCode=en&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># initial column name cleaning step</span>
<span class="n">well_exploration</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">well_exploration</span><span class="o">.</span><span class="n">columns</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;wlb&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;fld&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;fcl&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">well_exploration</span> <span class="o">=</span> <span class="n">well_exploration</span><span class="o">.</span><span class="n">clean_names</span><span class="p">(</span><span class="n">case_type</span><span class="o">=</span><span class="s2">&quot;snake&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Pandas doesn’t have a comprehensible list of methods to use in method chaining. But to make up for it, Pandas introduced Pipe function starting from version 0.16.2. Pipe enables user-defined methods in method chains.</p>
<p>With the introduction of pipe, you can almost write anything in a method chain which begets the question, How much chaining is too much?. This is an entirely subjective question and must be left to the discretion of the programmer. Most people find the sweet spot to be around 7 or 8 methods in a single chain. I don’t use any hard limits on the number of methods in a chain. Instead, I try to represent a single coherent thought in a single method chain.</p>
<p>Some of the critics of method chaining accuse it of increasing code readability at the cost of making debugging tricky, which is true. Imagine a chain that’s ten methods long that you are debugging after a month. The data frame structure or the column names have changed since then and now your chain starts throwing errors. Its impossible to now debug through the chain and see the changes it makes to the data frame as you move along the chain, albeit you can easily find which method call is
breaking the code. This needs to be addressed before starting to use long method chains in production or in notebooks.</p>
<div class="section" id="How-to-track-a-changing-of-the-dataframe-shape-along-the-chain?">
<h3>How to track a changing of the dataframe shape along the chain?<a class="headerlink" href="#How-to-track-a-changing-of-the-dataframe-shape-along-the-chain?" title="Permalink to this headline">¶</a></h3>
<p>Two things to note in this function are the:</p>
<ul class="simple">
<li><p>fn argument that can take in a lambda function</p></li>
<li><p>display function call</p></li>
</ul>
<p>Lambda function lends flexibility and the display function call makes the display of data frames and plots pretty in a Jupyter lab or a notebook setting.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">csnap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Custom Help function to print things in method chaining.</span>
<span class="sd">        Returns back the df to further use in chaining.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">fn</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">well_exploration</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check the dataframe shape</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wellbore_name&quot;</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">,</span> <span class="s2">&quot;drilling_operator&quot;</span><span class="p">,</span> <span class="s2">&quot;water_depth&quot;</span><span class="p">,</span> <span class="s2">&quot;total_depth&quot;</span><span class="p">])</span> <span class="c1"># select only 5 columns</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check the dataframe shape</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;water_depth &gt;= 1000&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check the dataframe shape</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(1922, 87)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(1922, 5)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(31, 5)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>water_depth</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1393</td>
      <td>6302/6-1</td>
      <td>6302/6-1</td>
      <td>Statoil ASA (old)</td>
      <td>1261.0</td>
      <td>4234.0</td>
    </tr>
    <tr>
      <td>1394</td>
      <td>6304/3-1</td>
      <td>6304/3-1</td>
      <td>A/S Norske Shell</td>
      <td>1235.3</td>
      <td>3642.0</td>
    </tr>
    <tr>
      <td>1396</td>
      <td>6305/4-1</td>
      <td>6305/4-1</td>
      <td>Norsk Hydro Produksjon AS</td>
      <td>1002.0</td>
      <td>2975.0</td>
    </tr>
    <tr>
      <td>1397</td>
      <td>6305/4-2 S</td>
      <td>6305/4-2</td>
      <td>A/S Norske Shell</td>
      <td>1086.0</td>
      <td>2985.0</td>
    </tr>
    <tr>
      <td>1413</td>
      <td>6403/6-1</td>
      <td>6403/6-1</td>
      <td>Statoil ASA (old)</td>
      <td>1721.0</td>
      <td>4120.0</td>
    </tr>
    <tr>
      <td>1414</td>
      <td>6403/10-1</td>
      <td>6403/10-1</td>
      <td>Norsk Hydro Produksjon AS</td>
      <td>1717.0</td>
      <td>3400.0</td>
    </tr>
    <tr>
      <td>1415</td>
      <td>6404/11-1</td>
      <td>6404/11-1</td>
      <td>BP Amoco Norge AS</td>
      <td>1495.0</td>
      <td>3650.0</td>
    </tr>
    <tr>
      <td>1416</td>
      <td>6405/7-1</td>
      <td>6405/7-1</td>
      <td>Statoil ASA (old)</td>
      <td>1206.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <td>1550</td>
      <td>6504/5-1 S</td>
      <td>6504/5-1</td>
      <td>Eni Norge AS</td>
      <td>1190.0</td>
      <td>4193.0</td>
    </tr>
    <tr>
      <td>1675</td>
      <td>6603/5-1 S</td>
      <td>6603/5-1</td>
      <td>A/S Norske Shell</td>
      <td>1452.0</td>
      <td>5254.0</td>
    </tr>
    <tr>
      <td>1676</td>
      <td>6603/12-1</td>
      <td>6603/12-1</td>
      <td>A/S Norske Shell</td>
      <td>1376.0</td>
      <td>3830.0</td>
    </tr>
    <tr>
      <td>1677</td>
      <td>6604/2-1</td>
      <td>6604/2-1</td>
      <td>BG Norge AS</td>
      <td>1262.0</td>
      <td>3551.0</td>
    </tr>
    <tr>
      <td>1678</td>
      <td>6604/5-1</td>
      <td>6604/5-1</td>
      <td>Wintershall Norge AS</td>
      <td>1219.0</td>
      <td>3858.0</td>
    </tr>
    <tr>
      <td>1679</td>
      <td>6604/6-1</td>
      <td>6604/6-1</td>
      <td>Wintershall Dea Norge AS</td>
      <td>1127.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>1680</td>
      <td>6604/10-1</td>
      <td>6604/10-1</td>
      <td>A/S Norske Shell</td>
      <td>1354.0</td>
      <td>3715.0</td>
    </tr>
    <tr>
      <td>1681</td>
      <td>6605/1-1</td>
      <td>6605/1-1</td>
      <td>StatoilHydro ASA</td>
      <td>1157.0</td>
      <td>3947.0</td>
    </tr>
    <tr>
      <td>1743</td>
      <td>6704/12-1</td>
      <td>6704/12-1</td>
      <td>Saga Petroleum ASA</td>
      <td>1352.0</td>
      <td>4103.0</td>
    </tr>
    <tr>
      <td>1744</td>
      <td>6705/7-1</td>
      <td>6705/7-1</td>
      <td>Repsol Norge AS</td>
      <td>1404.0</td>
      <td>3290.0</td>
    </tr>
    <tr>
      <td>1745</td>
      <td>6705/10-1</td>
      <td>6705/10-1</td>
      <td>StatoilHydro Petroleum AS</td>
      <td>1335.0</td>
      <td>3775.0</td>
    </tr>
    <tr>
      <td>1746</td>
      <td>6706/6-1</td>
      <td>6706/6-1</td>
      <td>Esso Exploration and Production Norway A/S</td>
      <td>1298.0</td>
      <td>3451.0</td>
    </tr>
    <tr>
      <td>1747</td>
      <td>6706/6-2 S</td>
      <td>6706/6-2</td>
      <td>Wintershall Norge AS</td>
      <td>1214.0</td>
      <td>3916.0</td>
    </tr>
    <tr>
      <td>1748</td>
      <td>6706/11-1</td>
      <td>6706/11-1</td>
      <td>Den norske stats oljeselskap a.s</td>
      <td>1238.0</td>
      <td>4317.0</td>
    </tr>
    <tr>
      <td>1749</td>
      <td>6706/11-2</td>
      <td>6706/11-2</td>
      <td>Statoil Petroleum AS</td>
      <td>1272.0</td>
      <td>2596.0</td>
    </tr>
    <tr>
      <td>1750</td>
      <td>6706/12-1</td>
      <td>6706/12-1</td>
      <td>StatoilHydro ASA</td>
      <td>1262.0</td>
      <td>3950.0</td>
    </tr>
    <tr>
      <td>1751</td>
      <td>6706/12-2</td>
      <td>6706/12-2</td>
      <td>Statoil Petroleum AS</td>
      <td>1312.0</td>
      <td>2754.0</td>
    </tr>
    <tr>
      <td>1752</td>
      <td>6706/12-3</td>
      <td>6706/12-3</td>
      <td>Statoil Petroleum AS</td>
      <td>1287.0</td>
      <td>3336.0</td>
    </tr>
    <tr>
      <td>1753</td>
      <td>6707/10-1</td>
      <td>6707/10-1</td>
      <td>BP Norway Limited U.A.</td>
      <td>1274.0</td>
      <td>5039.0</td>
    </tr>
    <tr>
      <td>1754</td>
      <td>6707/10-2 A</td>
      <td>6707/10-2</td>
      <td>StatoilHydro ASA</td>
      <td>1248.0</td>
      <td>4850.0</td>
    </tr>
    <tr>
      <td>1755</td>
      <td>6707/10-2 S</td>
      <td>6707/10-2</td>
      <td>StatoilHydro ASA</td>
      <td>1248.0</td>
      <td>3365.0</td>
    </tr>
    <tr>
      <td>1756</td>
      <td>6707/10-3 S</td>
      <td>6707/10-3</td>
      <td>Centrica Resources (Norge) AS</td>
      <td>1421.0</td>
      <td>4789.0</td>
    </tr>
    <tr>
      <td>1759</td>
      <td>7016/2-1</td>
      <td>7016/2-1</td>
      <td>Eni Norge AS</td>
      <td>1366.0</td>
      <td>4061.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can see how shape of the dataframe changed along the pipe in data processing pipeline:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1921</span><span class="p">,</span> <span class="mi">87</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1921</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pipe-seaborn’s-scatterplot-into-chain-of-methods">
<h2>pipe <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>’s scatterplot into chain of methods<a class="headerlink" href="#pipe-seaborn’s-scatterplot-into-chain-of-methods" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="p">(</span><span class="n">well_exploration</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wellbore_name&quot;</span><span class="p">,</span> <span class="s2">&quot;purpose&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="s2">&quot;drilling_operator&quot;</span><span class="p">,</span> <span class="s2">&quot;total_depth&quot;</span><span class="p">,</span> <span class="s2">&quot;water_depth&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check dataframe shape</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;content in [&#39;OIL&#39;, &#39;GAS&#39;]&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check dataframe shape</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">((</span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;total_depth&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="s1">&#39;water_depth&#39;</span><span class="p">,</span>
            <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;content&#39;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
 <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(1922, 6)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(632, 6)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_method_chaining_pandas_15_2.svg" src="../_images/notebooks_method_chaining_pandas_15_2.svg" /></div>
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="melt_and_pivot_table.html"
       title="previous chapter">← Reshape your dataframe to wide and long formats</a>
  </li>
  <li class="next">
    <a href="split_data_into_files_and_viceverse.html"
       title="next chapter">Split dataframe into multiple csv’s and load multiple csv’s into a single dataframe →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright Kristijan Bakaric.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>