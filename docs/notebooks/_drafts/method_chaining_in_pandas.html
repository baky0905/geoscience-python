<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>How method chaining in pandas is and can be super effective</title>
    
      <link rel="stylesheet" href="../../_static/pygments.css">
      <link rel="stylesheet" href="../../_static/theme.css">
      <link rel="stylesheet" href="../../_static/sphinx_press_theme.css">
      
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

      
      <script src="../../_static/theme-vendors.js"></script>
      <script src="../../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../../index.html" class="home-link">
    
      <span class="site-name">Geoscience with Python</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Introduction
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Data Sources
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Crash Course on Python Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Easy Plotting:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Pandas Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Exploratory Data Analysis (EDA) case studies - IN PROGRESS:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Well Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Seismic Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Spatial Data - IN PROGRESS
      </a>
    </div>
  



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Introduction
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Data Sources
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Crash Course on Python Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Easy Plotting:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Pandas Basics:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Exploratory Data Analysis (EDA) case studies - IN PROGRESS:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Well Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Seismic Data - IN PROGRESS
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way"
         class="nav-link ">
         Spatial Data - IN PROGRESS
      </a>
    </div>
  



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way">Introduction</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../../additional/welcome.html" class="reference internal ">Welcome to Geoscience with Python!</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way">Data Sources</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../../additional/data_sources.html" class="reference internal ">Data sources used</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way">Crash Course on Python Basics:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../crash.html" class="reference internal ">Crash Course on Python Basics</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way">Easy Plotting:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../plotly_express_intro.html" class="reference internal ">Intro to Interactive Plotting with plotly_express</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way">Pandas Basics:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../cleaning_columns_names.html" class="reference internal ">Load *.csv and clean column names</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../select_and_query.html" class="reference internal ">Select columns and filter rows</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../group_by_aggregate_assign.html" class="reference internal ">Group By, Summary Statistic and New Columns</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../melt_and_pivot_table.html" class="reference internal ">Reshape your dataframe to wide and long formats</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../method_chaining_pandas.html" class="reference internal ">How method chaining in pandas is and can be super effective</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way">Exploratory Data Analysis (EDA) case studies - IN PROGRESS:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../annual_hydrocarbon_production_NCS.html" class="reference internal ">Annual Hydrocarebon Production</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way">Well Data - IN PROGRESS</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way">Seismic Data - IN PROGRESS</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#welcome-to-geoscience-with-python-the-easy-way">Spatial Data - IN PROGRESS</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
    
    <li>How method chaining in pandas is and can be super effective</li>
  </ul>
  

  <ul class="page-nav">
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="How-method-chaining-in-pandas-is-and-can-be-super-effective">
<h1>How method chaining in pandas is and can be super effective<a class="headerlink" href="#How-method-chaining-in-pandas-is-and-can-be-super-effective" title="Permalink to this headline">¶</a></h1>
<p>Method chaining is a programmatic style of invoking multiple method calls sequentially with each call performing an action on the same object and returning it.</p>
<p>It eliminates the cognitive burden of naming variables at each intermediate step.</p>
<p>Fluent Interface, a method of creating object-oriented API relies on method cascading (aka method chaining).</p>
<p>Method chaining substantially increases the readability of the code.</p>
<p>It is a top down approach.</p>
<div class="section" id="Readable-and-understandable-code---chaining">
<h2>Readable and understandable code - chaining<a class="headerlink" href="#Readable-and-understandable-code---chaining" title="Permalink to this headline">¶</a></h2>
<p>I will always try to avoid the following two ways of writing code:</p>
<p><strong>1) MUTLIPLE OBJECT OPTION</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eat</span><span class="p">(</span>

    <span class="nb">slice</span><span class="p">(</span>

        <span class="n">bake</span><span class="p">(</span>

            <span class="n">put</span><span class="p">(</span>
                <span class="n">pour</span><span class="p">(</span>

                    <span class="n">mix</span><span class="p">(</span><span class="n">ingredients</span><span class="p">),</span>

                    <span class="n">into</span><span class="o">=</span><span class="n">baking_form</span><span class="p">),</span>

                    <span class="n">into</span><span class="o">=</span><span class="n">oven</span><span class="p">),</span>

                <span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>

            <span class="n">pieces</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
        <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This first option is considered a “nested” option such that functions are nested within one another. Historically, this has been the traditional way of integrating code; however, it becomes extremely difficult to read what exactly the code is doing and it also becomes easier to make mistakes when making updates to your code. Although not in violation of the DRY principle1, it definitely violates the basic principle of readability and clarity, which makes communication of your analysis more
difficult. To make things more readable, people often move to the following approach…</p>
<p><strong>2) NESTED OPTION</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="o">=</span> <span class="n">mix</span><span class="p">(</span><span class="n">ingredients</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">pour</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">into</span><span class="o">=</span><span class="n">baking_form</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">put</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">into</span><span class="o">=</span><span class="n">oven</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">bake</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">pieces</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">eat</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This second option helps in making the data wrangling steps more explicit and obvious but definitely violates the DRY principle. By sequencing multiple functions in this way you are likely saving multiple outputs that are not very informative to you or others; rather, the only reason you save them is to insert them into the next function to eventually get the final output you desire. This inevitably creates unnecessary copies and wrecks havoc on properly managing your objects…basically it
results in a global environment charlie foxtrot!</p>
<p><strong>I WILL INSIST ON METHODS CHAINING (if and when python and pandas allows you)</strong></p>
<p>To provide the same readability (or even better), we can use chaining of methods to string these arguments together without unnecessary object creation…</p>
<p>The point of the chain is to help you write code in a way that is easier to read and understand. It is powerful tool for clearly expressing a sequence of multiple operations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ingredients</span>

    <span class="o">.</span><span class="n">mix</span><span class="p">()</span>

    <span class="o">.</span><span class="n">pour</span><span class="p">(</span><span class="n">into</span><span class="o">=</span><span class="n">baking_form</span><span class="p">)</span>

    <span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">into</span><span class="o">=</span><span class="n">oven</span><span class="p">)</span>

    <span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

    <span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">pieces</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

    <span class="o">.</span><span class="n">ear</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">janitor</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_original</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://factpages.npd.no/ReportServer_npdpublic?/FactPages/TableView/wellbore_exploration_all&amp;rs:Command=Render&amp;rc:Toolbar=false&amp;rc:Parameters=f&amp;rs:Format=CSV&amp;Top100=false&amp;IpAddress=82.102.27.246&amp;CultureCode=en&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://factpages.npd.no/ReportServer_npdpublic?/FactPages/TableView/wellbore_exploration_all&amp;rs:Command=Render&amp;rc:Toolbar=false&amp;rc:Parameters=f&amp;rs:Format=CSV&amp;Top100=false&amp;IpAddress=82.102.27.246&amp;CultureCode=en&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># initial column name cleaning step</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;wlb&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;fld&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;fcl&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">clean_names</span><span class="p">(</span><span class="n">case_type</span><span class="o">=</span><span class="s2">&quot;snake&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>production_licence</th>
      <th>purpose</th>
      <th>status</th>
      <th>content</th>
      <th>well_type</th>
      <th>sub_sea</th>
      <th>entry_date</th>
      <th>...</th>
      <th>npdid_wellbore</th>
      <th>dsc_npdid_discovery</th>
      <th>npdid_field</th>
      <th>npdid_facility_drilling</th>
      <th>npdid_wellbore_reclass</th>
      <th>prl_npdid_production_licence</th>
      <th>npdid_site_survey</th>
      <th>date_updated</th>
      <th>date_updated_max</th>
      <th>datesync_npd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>1/2-1</td>
      <td>Phillips Petroleum Norsk AS</td>
      <td>143</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>20.03.1989</td>
      <td>...</td>
      <td>1382</td>
      <td>43814.0</td>
      <td>3437650.0</td>
      <td>296245.0</td>
      <td>0</td>
      <td>21956.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1/2-2</td>
      <td>1/2-2</td>
      <td>Paladin Resources Norge AS</td>
      <td>143 CS</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL SHOWS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.12.2005</td>
      <td>...</td>
      <td>5192</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>278245.0</td>
      <td>0</td>
      <td>2424919.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1/3-1</td>
      <td>1/3-1</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>06.07.1968</td>
      <td>...</td>
      <td>154</td>
      <td>43820.0</td>
      <td>NaN</td>
      <td>288604.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1/3-2</td>
      <td>1/3-2</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>DRY</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.05.1969</td>
      <td>...</td>
      <td>165</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>288847.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1/3-3</td>
      <td>1/3-3</td>
      <td>Elf Petroleum Norge AS</td>
      <td>065</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>22.08.1982</td>
      <td>...</td>
      <td>87</td>
      <td>43826.0</td>
      <td>1028599.0</td>
      <td>288334.0</td>
      <td>0</td>
      <td>21316.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 87 columns</p>
</div></div>
</div>
<p>Pandas doesn’t have a comprehensible list of methods to use in method chaining. But to make up for it, Pandas introduced Pipe function starting from version 0.16.2. Pipe enables user-defined methods in method chains.</p>
<p>With the introduction of pipe, you can almost write anything in a method chain which begets the question, How much chaining is too much?. This is an entirely subjective question and must be left to the discretion of the programmer. Most people find the sweet spot to be around 7 or 8 methods in a single chain. I don’t use any hard limits on the number of methods in a chain. Instead, I try to represent a single coherent thought in a single method chain.</p>
<p>Some of the critics of method chaining accuse it of increasing code readability at the cost of making debugging tricky, which is true. Imagine a chain that’s ten methods long that you are debugging after a month. The data frame structure or the column names have changed since then and now your chain starts throwing errors. Its impossible to now debug through the chain and see the changes it makes to the data frame as you move along the chain, albeit you can easily find which method call is
breaking the code. This needs to be addressed before starting to use long method chains in production or in notebooks.</p>
<div class="section" id="How-to-track-a-changing-of-the-dataframe-shape-along-the-chain?">
<h3>How to track a changing of the dataframe shape along the chain?<a class="headerlink" href="#How-to-track-a-changing-of-the-dataframe-shape-along-the-chain?" title="Permalink to this headline">¶</a></h3>
<p>Two things to note in this function are the:</p>
<ul class="simple">
<li><p>fn argument that can take in a lambda function</p></li>
<li><p>display function call</p></li>
</ul>
<p>Lambda function lends flexibility and the display function call makes the display of data frames and plots pretty in a Jupyter lab or a notebook setting.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">csnap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Custom Help function to print things in method chaining.</span>
<span class="sd">        Returns back the df to further use in chaining.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">fn</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">df</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check the dataframe shape</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wellbore_name&quot;</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">,</span> <span class="s2">&quot;drilling_operator&quot;</span><span class="p">,</span> <span class="s2">&quot;water_depth&quot;</span><span class="p">,</span> <span class="s2">&quot;total_depth&quot;</span><span class="p">])</span> <span class="c1"># select only 5 columns</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check the dataframe shape</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;water_depth &gt;= 1000&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check the dataframe shape</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Before
After
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>production_licence</th>
      <th>purpose</th>
      <th>status</th>
      <th>content</th>
      <th>well_type</th>
      <th>sub_sea</th>
      <th>entry_date</th>
      <th>...</th>
      <th>npdid_wellbore</th>
      <th>dsc_npdid_discovery</th>
      <th>npdid_field</th>
      <th>npdid_facility_drilling</th>
      <th>npdid_wellbore_reclass</th>
      <th>prl_npdid_production_licence</th>
      <th>npdid_site_survey</th>
      <th>date_updated</th>
      <th>date_updated_max</th>
      <th>datesync_npd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>1/2-1</td>
      <td>Phillips Petroleum Norsk AS</td>
      <td>143</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>20.03.1989</td>
      <td>...</td>
      <td>1382</td>
      <td>43814.0</td>
      <td>3437650.0</td>
      <td>296245.0</td>
      <td>0</td>
      <td>21956.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1/2-2</td>
      <td>1/2-2</td>
      <td>Paladin Resources Norge AS</td>
      <td>143 CS</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL SHOWS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.12.2005</td>
      <td>...</td>
      <td>5192</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>278245.0</td>
      <td>0</td>
      <td>2424919.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1/3-1</td>
      <td>1/3-1</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>06.07.1968</td>
      <td>...</td>
      <td>154</td>
      <td>43820.0</td>
      <td>NaN</td>
      <td>288604.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1/3-2</td>
      <td>1/3-2</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>DRY</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.05.1969</td>
      <td>...</td>
      <td>165</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>288847.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1/3-3</td>
      <td>1/3-3</td>
      <td>Elf Petroleum Norge AS</td>
      <td>065</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>22.08.1982</td>
      <td>...</td>
      <td>87</td>
      <td>43826.0</td>
      <td>1028599.0</td>
      <td>288334.0</td>
      <td>0</td>
      <td>21316.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 87 columns</p>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1921, 5)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>water_depth</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1393</td>
      <td>6302/6-1</td>
      <td>6302/6-1</td>
      <td>Statoil ASA (old)</td>
      <td>1261.0</td>
      <td>4234.0</td>
    </tr>
    <tr>
      <td>1394</td>
      <td>6304/3-1</td>
      <td>6304/3-1</td>
      <td>A/S Norske Shell</td>
      <td>1235.3</td>
      <td>3642.0</td>
    </tr>
    <tr>
      <td>1396</td>
      <td>6305/4-1</td>
      <td>6305/4-1</td>
      <td>Norsk Hydro Produksjon AS</td>
      <td>1002.0</td>
      <td>2975.0</td>
    </tr>
    <tr>
      <td>1397</td>
      <td>6305/4-2 S</td>
      <td>6305/4-2</td>
      <td>A/S Norske Shell</td>
      <td>1086.0</td>
      <td>2985.0</td>
    </tr>
    <tr>
      <td>1413</td>
      <td>6403/6-1</td>
      <td>6403/6-1</td>
      <td>Statoil ASA (old)</td>
      <td>1721.0</td>
      <td>4120.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>water_depth</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1393</td>
      <td>6302/6-1</td>
      <td>6302/6-1</td>
      <td>Statoil ASA (old)</td>
      <td>1261.0</td>
      <td>4234.0</td>
    </tr>
    <tr>
      <td>1394</td>
      <td>6304/3-1</td>
      <td>6304/3-1</td>
      <td>A/S Norske Shell</td>
      <td>1235.3</td>
      <td>3642.0</td>
    </tr>
    <tr>
      <td>1396</td>
      <td>6305/4-1</td>
      <td>6305/4-1</td>
      <td>Norsk Hydro Produksjon AS</td>
      <td>1002.0</td>
      <td>2975.0</td>
    </tr>
    <tr>
      <td>1397</td>
      <td>6305/4-2 S</td>
      <td>6305/4-2</td>
      <td>A/S Norske Shell</td>
      <td>1086.0</td>
      <td>2985.0</td>
    </tr>
    <tr>
      <td>1413</td>
      <td>6403/6-1</td>
      <td>6403/6-1</td>
      <td>Statoil ASA (old)</td>
      <td>1721.0</td>
      <td>4120.0</td>
    </tr>
    <tr>
      <td>1414</td>
      <td>6403/10-1</td>
      <td>6403/10-1</td>
      <td>Norsk Hydro Produksjon AS</td>
      <td>1717.0</td>
      <td>3400.0</td>
    </tr>
    <tr>
      <td>1415</td>
      <td>6404/11-1</td>
      <td>6404/11-1</td>
      <td>BP Amoco Norge AS</td>
      <td>1495.0</td>
      <td>3650.0</td>
    </tr>
    <tr>
      <td>1416</td>
      <td>6405/7-1</td>
      <td>6405/7-1</td>
      <td>Statoil ASA (old)</td>
      <td>1206.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <td>1550</td>
      <td>6504/5-1 S</td>
      <td>6504/5-1</td>
      <td>Eni Norge AS</td>
      <td>1190.0</td>
      <td>4193.0</td>
    </tr>
    <tr>
      <td>1675</td>
      <td>6603/5-1 S</td>
      <td>6603/5-1</td>
      <td>A/S Norske Shell</td>
      <td>1452.0</td>
      <td>5254.0</td>
    </tr>
    <tr>
      <td>1676</td>
      <td>6603/12-1</td>
      <td>6603/12-1</td>
      <td>A/S Norske Shell</td>
      <td>1376.0</td>
      <td>3830.0</td>
    </tr>
    <tr>
      <td>1677</td>
      <td>6604/2-1</td>
      <td>6604/2-1</td>
      <td>BG Norge AS</td>
      <td>1262.0</td>
      <td>3551.0</td>
    </tr>
    <tr>
      <td>1678</td>
      <td>6604/5-1</td>
      <td>6604/5-1</td>
      <td>Wintershall Norge AS</td>
      <td>1219.0</td>
      <td>3858.0</td>
    </tr>
    <tr>
      <td>1679</td>
      <td>6604/10-1</td>
      <td>6604/10-1</td>
      <td>A/S Norske Shell</td>
      <td>1354.0</td>
      <td>3715.0</td>
    </tr>
    <tr>
      <td>1680</td>
      <td>6605/1-1</td>
      <td>6605/1-1</td>
      <td>StatoilHydro ASA</td>
      <td>1157.0</td>
      <td>3947.0</td>
    </tr>
    <tr>
      <td>1742</td>
      <td>6704/12-1</td>
      <td>6704/12-1</td>
      <td>Saga Petroleum ASA</td>
      <td>1352.0</td>
      <td>4103.0</td>
    </tr>
    <tr>
      <td>1743</td>
      <td>6705/7-1</td>
      <td>6705/7-1</td>
      <td>Repsol Norge AS</td>
      <td>1404.0</td>
      <td>3290.0</td>
    </tr>
    <tr>
      <td>1744</td>
      <td>6705/10-1</td>
      <td>6705/10-1</td>
      <td>StatoilHydro Petroleum AS</td>
      <td>1335.0</td>
      <td>3775.0</td>
    </tr>
    <tr>
      <td>1745</td>
      <td>6706/6-1</td>
      <td>6706/6-1</td>
      <td>Esso Exploration and Production Norway A/S</td>
      <td>1298.0</td>
      <td>3451.0</td>
    </tr>
    <tr>
      <td>1746</td>
      <td>6706/6-2 S</td>
      <td>6706/6-2</td>
      <td>Wintershall Norge AS</td>
      <td>1214.0</td>
      <td>3916.0</td>
    </tr>
    <tr>
      <td>1747</td>
      <td>6706/11-1</td>
      <td>6706/11-1</td>
      <td>Den norske stats oljeselskap a.s</td>
      <td>1238.0</td>
      <td>4317.0</td>
    </tr>
    <tr>
      <td>1748</td>
      <td>6706/11-2</td>
      <td>6706/11-2</td>
      <td>Statoil Petroleum AS</td>
      <td>1272.0</td>
      <td>2596.0</td>
    </tr>
    <tr>
      <td>1749</td>
      <td>6706/12-1</td>
      <td>6706/12-1</td>
      <td>StatoilHydro ASA</td>
      <td>1262.0</td>
      <td>3950.0</td>
    </tr>
    <tr>
      <td>1750</td>
      <td>6706/12-2</td>
      <td>6706/12-2</td>
      <td>Statoil Petroleum AS</td>
      <td>1312.0</td>
      <td>2754.0</td>
    </tr>
    <tr>
      <td>1751</td>
      <td>6706/12-3</td>
      <td>6706/12-3</td>
      <td>Statoil Petroleum AS</td>
      <td>1287.0</td>
      <td>3336.0</td>
    </tr>
    <tr>
      <td>1752</td>
      <td>6707/10-1</td>
      <td>6707/10-1</td>
      <td>BP Norway Limited U.A.</td>
      <td>1274.0</td>
      <td>5039.0</td>
    </tr>
    <tr>
      <td>1753</td>
      <td>6707/10-2 A</td>
      <td>6707/10-2</td>
      <td>StatoilHydro ASA</td>
      <td>1248.0</td>
      <td>4850.0</td>
    </tr>
    <tr>
      <td>1754</td>
      <td>6707/10-2 S</td>
      <td>6707/10-2</td>
      <td>StatoilHydro ASA</td>
      <td>1248.0</td>
      <td>3365.0</td>
    </tr>
    <tr>
      <td>1755</td>
      <td>6707/10-3 S</td>
      <td>6707/10-3</td>
      <td>Centrica Resources (Norge) AS</td>
      <td>1421.0</td>
      <td>4789.0</td>
    </tr>
    <tr>
      <td>1758</td>
      <td>7016/2-1</td>
      <td>7016/2-1</td>
      <td>Eni Norge AS</td>
      <td>1366.0</td>
      <td>4061.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can see how shape of the dataframe changed along the pipe in data processing pipeline:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1921</span><span class="p">,</span> <span class="mi">87</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1921</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s look at the other custom pipe functions. setcols is used to set column names in a chain. Usually when we read data from an external source the column name will contain a mix of upper and lower cases along with space and special characters. These issues can be fixed like this,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">setcols</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">fnc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">),</span> <span class="n">cols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the column of the data frame to the passed column list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cols</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cols</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">fnc</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">df_original</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span>
        <span class="n">setcols</span><span class="p">,</span>
        <span class="n">fnc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;wlb&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;fld&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span>

<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1921, 87)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1921, 87)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellborename</th>
      <th>well</th>
      <th>drillingoperator</th>
      <th>productionlicence</th>
      <th>purpose</th>
      <th>status</th>
      <th>content</th>
      <th>welltype</th>
      <th>subsea</th>
      <th>entrydate</th>
      <th>...</th>
      <th>npdidwellbore</th>
      <th>dscnpdiddiscovery</th>
      <th>npdidfield</th>
      <th>fclnpdidfacilitydrilling</th>
      <th>npdidwellborereclass</th>
      <th>prlnpdidproductionlicence</th>
      <th>npdidsitesurvey</th>
      <th>dateupdated</th>
      <th>dateupdatedmax</th>
      <th>datesyncnpd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>1/2-1</td>
      <td>Phillips Petroleum Norsk AS</td>
      <td>143</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>20.03.1989</td>
      <td>...</td>
      <td>1382</td>
      <td>43814.0</td>
      <td>3437650.0</td>
      <td>296245.0</td>
      <td>0</td>
      <td>21956.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1/2-2</td>
      <td>1/2-2</td>
      <td>Paladin Resources Norge AS</td>
      <td>143 CS</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL SHOWS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.12.2005</td>
      <td>...</td>
      <td>5192</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>278245.0</td>
      <td>0</td>
      <td>2424919.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1/3-1</td>
      <td>1/3-1</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>06.07.1968</td>
      <td>...</td>
      <td>154</td>
      <td>43820.0</td>
      <td>NaN</td>
      <td>288604.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1/3-2</td>
      <td>1/3-2</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>DRY</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.05.1969</td>
      <td>...</td>
      <td>165</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>288847.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1/3-3</td>
      <td>1/3-3</td>
      <td>Elf Petroleum Norge AS</td>
      <td>065</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>22.08.1982</td>
      <td>...</td>
      <td>87</td>
      <td>43826.0</td>
      <td>1028599.0</td>
      <td>288334.0</td>
      <td>0</td>
      <td>21316.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>1916</td>
      <td>7324/10-1</td>
      <td>7324/10-1</td>
      <td>Den norske stats oljeselskap a.s</td>
      <td>162</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>SHOWS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>03.06.1989</td>
      <td>...</td>
      <td>1411</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>294382.0</td>
      <td>0</td>
      <td>22108.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>1917</td>
      <td>7325/1-1</td>
      <td>7325/1-1</td>
      <td>Statoil Petroleum AS</td>
      <td>615</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>23.06.2014</td>
      <td>...</td>
      <td>7501</td>
      <td>24689817.0</td>
      <td>NaN</td>
      <td>404201.0</td>
      <td>0</td>
      <td>20429544.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>1918</td>
      <td>7325/4-1</td>
      <td>7325/4-1</td>
      <td>Statoil Petroleum AS</td>
      <td>855</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL/GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>19.07.2017</td>
      <td>...</td>
      <td>8211</td>
      <td>29469097.0</td>
      <td>NaN</td>
      <td>439972.0</td>
      <td>0</td>
      <td>28168828.0</td>
      <td>NaN</td>
      <td>13.11.2019</td>
      <td>13.11.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>1919</td>
      <td>7335/3-1</td>
      <td>7335/3-1</td>
      <td>Equinor Energy AS</td>
      <td>859</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>DRY</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>13.05.2019</td>
      <td>...</td>
      <td>8735</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>415836.0</td>
      <td>0</td>
      <td>28169055.0</td>
      <td>NaN</td>
      <td>17.10.2019</td>
      <td>NaN</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>1920</td>
      <td>7435/12-1</td>
      <td>7435/12-1</td>
      <td>Statoil Petroleum AS</td>
      <td>859</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>09.08.2017</td>
      <td>...</td>
      <td>8228</td>
      <td>29491696.0</td>
      <td>NaN</td>
      <td>439972.0</td>
      <td>0</td>
      <td>28169055.0</td>
      <td>NaN</td>
      <td>01.11.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
  </tbody>
</table>
<p>1921 rows × 87 columns</p>
</div></div>
</div>
<p>Unlike the csnap function setcols function creates a copy of the data frame, which makes the function call costly. But this is necessary to make sure that we are not writing on the global copy of the data frame. Most of the pandas function works similarly with an in-place flag to either return the new data frame or reassign the top level reference.</p>
<p>Jeff Reback says, There is no guarantee that an in-place operation is actually faster. Often, they are the same operation that works on a copy, but the top-level reference is reassigned.</p>
<p>Let’s wrap this section with one final example. R has a versatile select function to select/deselect columns in a wide data frame instead of listing out everything. cfilter helps us achieve the same versatility using lambda function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">cfilter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;rows&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Custom Filters based on a condition and returns the df.</span>
<span class="sd">        function - a lambda function that returns a binary vector</span>
<span class="sd">        thats similar in shape to the dataframe</span>
<span class="sd">        axis = rows or columns to be filtered.</span>
<span class="sd">        A single level indexing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;rows&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">fn</span><span class="p">(</span><span class="n">df</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;columns&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">fn</span><span class="p">(</span><span class="n">df</span><span class="p">)]</span>

<span class="p">(</span><span class="n">df</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">cfilter</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;well&quot;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellborename</th>
      <th>well</th>
      <th>welltype</th>
      <th>discoverywellbore</th>
      <th>reclassfromwellbore</th>
      <th>diskoswellboretype</th>
      <th>diskoswellboreparent</th>
      <th>npdidwellbore</th>
      <th>npdidwellborereclass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>1/2-1</td>
      <td>EXPLORATION</td>
      <td>YES</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>1382</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1/2-2</td>
      <td>1/2-2</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>5192</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1/3-1</td>
      <td>1/3-1</td>
      <td>EXPLORATION</td>
      <td>YES</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>154</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1/3-2</td>
      <td>1/3-2</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>165</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1/3-3</td>
      <td>1/3-3</td>
      <td>EXPLORATION</td>
      <td>YES</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>87</td>
      <td>0</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>1916</td>
      <td>7324/10-1</td>
      <td>7324/10-1</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>1411</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1917</td>
      <td>7325/1-1</td>
      <td>7325/1-1</td>
      <td>EXPLORATION</td>
      <td>YES</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>7501</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1918</td>
      <td>7325/4-1</td>
      <td>7325/4-1</td>
      <td>EXPLORATION</td>
      <td>YES</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>8211</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1919</td>
      <td>7335/3-1</td>
      <td>7335/3-1</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>8735</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1920</td>
      <td>7435/12-1</td>
      <td>7435/12-1</td>
      <td>EXPLORATION</td>
      <td>YES</td>
      <td>NaN</td>
      <td>initial</td>
      <td></td>
      <td>8228</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1921 rows × 9 columns</p>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;

            setTimeout(function() {
                var nbb_cell_id = 61;
                var nbb_formatted_code = "def cfilter(df, fn, axis=\"rows\"):\n    \"\"\" Custom Filters based on a condition and returns the df.\n        function - a lambda function that returns a binary vector\n        thats similar in shape to the dataframe\n        axis = rows or columns to be filtered.\n        A single level indexing\n    \"\"\"\n    if axis == \"rows\":\n        return df[fn(df)]\n    elif axis == \"columns\":\n        return df.iloc[:, fn(df)]\n\n\n(df.pipe(cfilter, lambda x: x.columns.str.contains(\"well\"), axis=\"columns\"))";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        nbb_cells[i].set_text(nbb_formatted_code);
                        break;
                    }
                }
            }, 500);

</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
</ul><div class="footer" role="contentinfo">
      &#169; Copyright Kristijan Bakaric.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>